# Database 정규화(Normalization)
## 데이터베이스 정규화
-> `이상 문제`를 해결하기 위해 속성들 끼리의 `종속 관계(함수적 종속)`를 분석하여 여러개의 릴레이션으로 분해하는 과정입니다. 테이블을 여러개로 분해하면 속도는 상대적으로 느려질 수 있지만, 분해하지 않으면 이상 문제들이 발생합니다.

> **이상 문제**  
> 1. 삽입이상: 데이터를 저장할 때 원하지 않는 정보가 함께 삽입되는 경우  
> 2. 삭제이상: 튜플을 삭제함으로써 유지되어야 하는 정보 까지도 연쇄적으로 삭제되는 경우  
> 3. 갱신이상: 중복된 튜플 중 일부의 속성만 갱신 시킴으로써 모순성이 발생하는 경우   
![](img/Screen%20Shot%202021-04-11%20at%203.41.46%20PM.png)

> **함수적 종속이란?**  
> 함수적 종속은 어떠한 릴레이션에서 속성들의 부분 집합을 X, Y라 할 때, 특정 튜플에서 X의 값이 Y의 값을 함수적으로 결정한다면 **Y가 X에 함수적으로 종속되었다**고 합니다.  

## 정규화 과정
### 제 1정규형(1NF)
도메인은 모두 원자값이어야 합니다. 핸드폰 번호에 2가지가 들어가 있기 때문에 제1정규형을 만족할 수 없게 됩니다.
![](img/Screen%20Shot%202021-04-11%20at%203.45.59%20PM.png)

### 제 2정규형(2NF)
-> 제2 정규형은 **부분 함수 종속(Partial Functional Dependency)**을 제거 합니다.

![](img/Screen%20Shot%202021-04-11%20at%203.48.29%20PM.png)
함수(학번, 과목코드)에서 부분 함수인 학번 혼자서 학부와 등록금을 결정할 수 있기때문에 제2 정규형을 만족하지 않습니다. 아래와 같이 분리시킵니다.
![](img/Screen%20Shot%202021-04-11%20at%203.51.57%20PM.png)

### 제 3정규형(3NF)
제3 정규형은 **이행 함수 종속(Transitive Functional Dependency)**을 제거합니다.(이행 규칙: X -> Y 이고 Y -> 이면 X -> Z 이다.)
![](img/Screen%20Shot%202021-04-11%20at%203.56.18%20PM.png)
위의 테이블은 이행규칙을 만족하므로 제3 정규형을 만족시키지 못하며, 이행 함수 종속을 제거해주어야 합니다. 또한, 위의 상태에서는 갱신 이상이나 여러 문제가 발생할 수 있기 때문에 X -> Y, Y -> Z의 형태로 릴레이션을 또 다시 분해합니다.
![](img/Screen%20Shot%202021-04-11%20at%203.56.30%20PM.png)

### BCNF(Boyce and Codd Normal Form)
**어떤 테이블의 결정자(Determinant)가 후보키인 경우를 말합니다**. BCNF는 제 3정규형보다 강한 정규형입니다. 즉, BCNF를 만족하면 제 3정규형도 만족하지만, 제 3정규형을 만족할 때 BCNF를 만족할지는 모르는 일입니다.
![](img/Screen%20Shot%202021-04-16%20at%209.27.03%20PM.png)
위 테이블의 후보키는 "사용자 명", "소유 코인 명" 입니다. 따라서 두 컬럼을 통해 레코드를 구별할 수 있습니다.
그러나 소유 코인 명에 의해 코인 배급사가 결정되는 관계가 존재하여 BCNF 를 만족하지 않으므로, 아래와 같이 분리하여야 합니다.
![](img/Screen%20Shot%202021-04-16%20at%209.27.51%20PM.png)

> **결정자란**  
> x -> y 일때 y는 x에 종속된다라고 말하고, x가 결정자이다.  

## Reference
* https://nirsa.tistory.com/107
* https://3months.tistory.com/193
* https://mozi.tistory.com/110
* https://lelumiere.tistory.com/12

